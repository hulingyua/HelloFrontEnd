### fs - 文件系统

- 写入文件:`fs.writeFile(file, data[, options], callback)`

```javascript
var fs = require('fs');
var msg = '但愿人长久，千里共婵娟。';
fs.writeFile('./data.txt',msg,function(err){
  if(err){
    throw err;
  }
  console.log('写入成功');
});
console.log('异步操作');
// 异步操作
// 写入成功
```

- 读取文件:`fs.readFile(path[, options], callback)`

```javascript
// path相对的是Node执行命令所在的路径
var fs = require('fs');
fs.readFile('./data.txt','utf8',function(err,data){
  // if(err) throw err;
  // E:\Program Files\wamp\www\node\1111.js:3
  // if(err) throw err;
  //         ^
  // Error: ENOENT: no such file or directory, open 'E:\Program Files\wamp\www\node\data1.txt'
  //   at Error (native)

  // ENOENT Error No Entity

  // if(err) return console.log(err);
  // { Error: ENOENT: no such file or directory, open 'E:\Program Files\wamp\www\node\data1.txt'
  // at Error (native)
  // errno: -4058,
  // code: 'ENOENT',
  // syscall: 'open',
  // path: 'E:\\Program Files\\wamp\\www\\node\\data1.txt' }
  if(err){
    throw err;
    // 异步不能使用try...catch...
  }
  // console.log(data);
  // <Buffer 64 6f 6e 27 74 20 6c 65 74 20 6d 65 20 67 6f 2e>
  // Buffer是一个缓冲二进制数据,2位16进制的字节数组,负责传输文件
  
  // 转化为字符串方法1: toString()
  // 转化为字符串方法2: 设置第二个参数,编码格式为'utf8'/'utf-8'
  console.log(data.toString());
});
```

- 同步读取文件:`fs.readFileSync(path[, options])`

```javascript
var fs = require('fs');
// 同步使用try...catch...捕获异常
try{
  var data = fs.readFileSync('./data1.txt','utf8');
  console.log(data);
}catch(err){
  console.log(`ERROR=>${err}`);
  // ERROR=>Error: ENOENT: no such file or directory, open 'E:\Program Files\wamp\www\node\data1.txt'
}
```

### __dirname - 当前模块的文件夹名称

```javascript
// 当前 js 文件所在的`文件夹`目录
console.log(__dirname); // E:\Program Files\wamp\www\node
// 应用：path使用绝对路径
var fs = require('fs');
var path = require('path');
fs.readFile(path.join(__dirname,'./data.txt'),'utf8',function(err,data){
  if(err){
    throw err;
  }
  console.log(data);
})
```

### HTTP服务

```javascript
// 极简
var http = require('http');
var server = http.createServer();
server.on('request',function(req,res){
  console.log('有请求了！');
  res.write('Hello world!');
  res.end();
})

server.listen(8080,function(){
  console.log('服务已开启于：http://localhost:8080');
})

// 一体化
var http = require('http');
http.createServer(function(req,res){
  console.log('有请求了！');
  res.setHeader('content-type','text/plain;charset=utf-8');
  //  text/plain  告诉浏览器以纯文本的格式进行解析内容
  //  charset=utf-8 告诉浏览器以 utf-8 编码格式解析文字
  res.end('<h1>一级标题</h1>');
}).listen(8080,function(){
  console.log('服务已开启于：http://localhost:8080');
})
```

### 根据不同的URL请求响应不同的纯文本

```javascript
var http = require('http');
http.createServer(function(req,res){
  console.log(req.url);
  res.setHeader('content-type','text/plain;charset=utf-8');
  if(req.url === '/' || req.url === '/index'){
    res.end('这是首页');
  }else if(req.url === '/login'){
    res.end('这是登录页');    
  }else if(req.url === '/register'){
    res.end('这是注册页');        
  }else{
    res.end('404 no found page');        
  }
}).listen(8080,function(){
  console.log('服务已开启于：http://localhost:8080');
})
```

